GO
PRINT N'Altering [Lookup].[LocalArea]...';

DECLARE @tblLocalArea TABLE  (
	Id UNIQUEIDENTIFIER NOT NULL, 
	[NAME] NVARCHAR(1024) NOT NULL,
	CompetentAuthorityId UNIQUEIDENTIFIER NOT NULL
)

INSERT INTO @tblLocalArea (Id, [Name], CompetentAuthorityId)
VALUES ('E0D36DE0-F2CB-400A-A290-E830A544C4C9', 'North East (NEA)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('0B04DC2A-DAA7-49A6-9CB3-4B4202CFE122', 'Cumbria and Lancashire (CLA)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('5921BB40-B313-4A5E-919A-BBD1B866C0D2', 'Yorkshire (YOR)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('7309D7EC-6F80-4683-BCBF-665FC69C2DAF', 'Greater Manchester, Merseyside and Cheshire (GMC)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('8DEDFDC2-9041-447F-88D3-D5AA3E3B0AF0', 'Lincolnshire and Northamptonshire (LNA)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('3D19B4CA-A818-421D-B51C-7091D9D33D98', 'East Midlands (EMD)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('C9CAFB85-1AB0-4192-872F-2BCB8EAD357B', 'West Midlands (WMD)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('CDFB7F17-0D57-4DE8-8408-ACF7365CF6EE', 'Wessex (WSX)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('65753EC0-623F-4319-999E-1AB6741DE98B', 'Devon, Cornwall and the Isles of Scilly (DCS)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('4DDAD596-153B-436F-B1E2-31FEA920AFB3', 'East Anglia (EAN)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('D62B24A3-BC5B-43F7-A042-EA7AADBFE4E6', 'Thames (THM)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('32D96069-EF88-41D4-A35A-D060C40084A2', 'Hertfordshire and North London (HNL)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('024D201E-60A6-475C-9CB0-F0C2AD123B8B', 'Kent, South London and East Sussex (KSL)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8'),
('41C5FFAF-E4FB-4DD1-BF30-E5EC53F36E59', 'Solent and South Downs (SSD)', 'A3C2D0DD-53A1-4F6A-99D0-1CCFC87611A8')

INSERT INTO [Lookup].LocalArea (Id , [Name], CompetentAuthorityId)
SELECT tmp.[Id], tmp.[NAME], tmp.CompetentAuthorityId
FROM @tblLocalArea tmp
LEFT JOIN [Lookup].[LocalArea] tbl ON tbl.[Id] = tmp.[Id]
WHERE tbl.[Id] IS NULL

UPDATE LiveTable SET
LiveTable.[Name] = tmp.[Name],
LiveTable.CompetentAuthorityId = tmp.CompetentAuthorityId
FROM [Lookup].[LocalArea] LiveTable 
INNER JOIN @tblLocalArea tmp ON LiveTable.[Id] = tmp.[Id]

GO
PRINT N'Update complete.';

GO